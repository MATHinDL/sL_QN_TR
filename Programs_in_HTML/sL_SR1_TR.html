<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2021a"><title>Algorithm sL-SR1-TR</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S3 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S4 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 17.234px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S8 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S9 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span style=' font-weight: bold;'>Algorithm sL-SR1-TR</span></h1><div  class = 'S1'><span>This document provides step by step programing for training ResNet-20 or ConvNet3FC2 </span><span style=' font-weight: bold; text-decoration: underline;'>with BN layers</span><span> on MNIST, Fashion MNIST or CIFAR10. </span></div><ul  class = 'S2'><li  class = 'S3'><span>Notice to the structure of networks including BN layers. </span></li><li  class = 'S3'><span>Notice to make coments (</span><span style=' font-family: monospace;'>%</span><span>) other networks and datasets after selecting one of them.</span></li><li  class = 'S3'><span>Notice to TR solver and gamma computation. </span></li></ul><div  class = 'S1'><span style=' font-weight: bold;'>Defaults:</span><span> </span><span style=' font-family: monospace;'>os   = 500  (bs = 1000), epoch  = 10 ,  lim_m = 20</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >clear</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >clc</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >close </span><span style="color: rgb(170, 4, 249);">all</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >rng </span><span style="color: rgb(170, 4, 249);">default</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div></div><h1  class = 'S7'><span style=' font-weight: bold;'>Load Data</span></h1><div  class = 'S1'><span style=' font-weight: bold;'>Train and Test (images): 4D double</span></div><div  class = 'S1'><span style=' font-weight: bold;'>Train and Test (label): categorical</span></div><h2  class = 'S8'><span style=' font-weight: bold;'>1. MNIST</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >[XTrain, yTrain, XTest, yTest] = loadDataMnist;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >input_image_size               = [28 28 1];</span></span></div></div></div><h2  class = 'S8'><span>2. Fashion-MNIST</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% [XTrain, yTrain, XTest, yTest] = loadData_FashionMnist;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% input_image_size               = [28 28 1];</span></span></div></div></div><h2  class = 'S8'><span>3. CIFAR10</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% [XTrain, yTrain, XTest, yTest] = loadDataCifar10;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% input_image_size               = [32 32 3];</span></span></div></div></div><div  class = 'S9'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >classes                       = categories(yTrain);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >numClasses                    = numel(classes);  </span><span style="color: rgb(2, 128, 9);">% 10</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >num_of_Train_Images           = size(XTrain,4);  </span><span style="color: rgb(2, 128, 9);">% 50,000 (Cifar10) or 60,000 (Mnist and F.Mnist)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >num_of_Test_Images            = size(XTest,4);   </span><span style="color: rgb(2, 128, 9);">% 10,000</span></span></div></div></div><h1  class = 'S7'><span style=' font-weight: bold;'>One-hot label</span></h1><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% One-hot labels for train set:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >YTrain = zeros(numClasses, num_of_Train_Images, </span><span style="color: rgb(170, 4, 249);">'single'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >c  = 2:10</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    YTrain( c-1, yTrain == classes(c)) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >YTrain( 10, yTrain == classes(1)) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% One-hot labels for test set:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >YTest = zeros(numClasses, num_of_Test_Images, </span><span style="color: rgb(170, 4, 249);">'single'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >c = 2:10</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    YTest( c-1, yTest == classes(c) ) = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >YTest( 10, yTest == classes(1) ) = 1;</span></span></div></div></div><h1  class = 'S7'><span style=' font-weight: bold;'>Convert Test set from 4D double to 4D single &gt; dlArray &gt; gpuArray</span></h1><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >executionEnvironment = </span><span style="color: rgb(170, 4, 249);">"auto"</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >XTest   = dlarray(single(XTest),</span><span style="color: rgb(170, 4, 249);">'SSCB'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >(executionEnvironment == </span><span style="color: rgb(170, 4, 249);">"auto" </span><span >&amp;&amp; canUseGPU) || executionEnvironment == </span><span style="color: rgb(170, 4, 249);">"gpu"</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    XTest = gpuArray(XTest);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><span style=' font-weight: bold;'>NOTE: </span><span>This conversion needs also for train set but after making mini- or multi-batches; (see </span><span style=' font-family: monospace;'>get_Jk.m</span><span>) </span></div><h1  class = 'S7'><span style=' font-weight: bold;'>Architecture of Network with BN</span></h1><h2  class = 'S8'><span style=' font-weight: bold;'>1. ConvNet3FC2</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% layers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     imageInputLayer(input_image_size, 'Name', 'input', 'Normalization','zscore',...</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     'Mean', mean(XTrain,4), 'StandardDeviation', std(XTrain, 0, 4))</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     % ConvNet</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     convolution2dLayer(5, 32, 'Stride', 1,'Padding', 2,'Name','conv1')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     batchNormalizationLayer('Name','bn1')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     reluLayer('Name','relu1')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     maxPooling2dLayer(2,'Stride', 1, 'Name', 'pooling_max1')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     % ConvNet</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     convolution2dLayer(5, 32,'Stride', 1, 'Padding', 2,'Name','conv2')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     batchNormalizationLayer('Name','bn2')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     reluLayer('Name','relu2')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     maxPooling2dLayer(2,'Stride', 1, 'Name', 'pooling_max2')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     % ConvNet</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     convolution2dLayer(5, 64,'Stride', 1,'Padding', 2,'Name','conv3')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     batchNormalizationLayer('Name','bn3')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     reluLayer('Name','relu3')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     maxPooling2dLayer(2,'Stride', 1, 'Name', 'pooling_max3')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     % FC</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     fullyConnectedLayer(64,'Name','fc1')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     batchNormalizationLayer('Name','bn4')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     reluLayer('Name','relu4')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     % FC</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     fullyConnectedLayer(numClasses,'Name','fc2')</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%     softmaxLayer('Name','softmax')];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% lgraph = layerGraph(layers);</span></span></div></div></div><h2  class = 'S8'><span style=' font-weight: bold;'>2. ResNet-20</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >lgraph = layerGraph();</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >imageInputLayer(input_image_size, </span><span style="color: rgb(170, 4, 249);">'Name'</span><span >, </span><span style="color: rgb(170, 4, 249);">'imageinput'</span><span >, </span><span style="color: rgb(170, 4, 249);">'Normalization'</span><span >,</span><span style="color: rgb(170, 4, 249);">'zscore'</span><span >,</span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(170, 4, 249);">'Mean'</span><span >, mean(XTrain,4), </span><span style="color: rgb(170, 4, 249);">'StandardDeviation'</span><span >, std(XTrain, 0, 4))</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >convolution2dLayer([3 3],16,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_1"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_1"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_1"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% B1:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],16,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_2"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_2"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_2"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],16,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_3"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_3"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    additionLayer(2,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_1"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_3"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% B2:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],16,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_4"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_4"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_4"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],16,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_5"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_5"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    additionLayer(2,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_2"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_5"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% B3:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],16,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_6"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_6"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_6"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],16,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_7"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_7"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    additionLayer(2,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_3"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_7"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%===========================================================</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% B1:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],32,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_8"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1],</span><span style="color: rgb(170, 4, 249);">"Stride"</span><span >,[2 2])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_8"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_8"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],32,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_9"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_9"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([1 1],32,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_10"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Stride"</span><span >,[2 2])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_10"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    additionLayer(2,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_4"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_9"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% B2:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],32,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_11"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_11"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_10"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],32,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_12"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_12"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    additionLayer(2,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_5"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_11"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% B3:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],32,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_13"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_13"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_12"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],32,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_14"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_14"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    additionLayer(2,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_6"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_13"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">%===========================================================</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% B1:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],64,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_15"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1],</span><span style="color: rgb(170, 4, 249);">"Stride"</span><span >,[2 2])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_15"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_14"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],64,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_16"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_16"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([1 1],64,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_17"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Stride"</span><span >,[2 2])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_17"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    additionLayer(2,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_7"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_15"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% B2:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],64,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_18"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_18"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_16"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],64,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_19"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_19"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    additionLayer(2,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_8"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_17"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% B3:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],64,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_20"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_20"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_18"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    convolution2dLayer([3 3],64,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_21"</span><span >,</span><span style="color: rgb(170, 4, 249);">"Padding"</span><span >,[1 1 1 1])</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    batchNormalizationLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"batchnorm_21"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tempLayers = [</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    additionLayer(2,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_9"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    reluLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"relu_19"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    globalAveragePooling2dLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"gapool"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    fullyConnectedLayer(10,</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"fc"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    softmaxLayer(</span><span style="color: rgb(170, 4, 249);">"Name"</span><span >,</span><span style="color: rgb(170, 4, 249);">"softmax"</span><span >)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = addLayers(lgraph,tempLayers);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(2, 128, 9);">% clean up helper variable</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >clear </span><span style="color: rgb(170, 4, 249);">tempLayers</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_1"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_2"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_1"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_1/in2"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"batchnorm_3"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_1/in1"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_3"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_4"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_3"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_2/in2"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"batchnorm_5"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_2/in1"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_5"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_6"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_5"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_3/in2"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"batchnorm_7"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_3/in1"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_7"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_8"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_7"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_10"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"batchnorm_10"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_4/in2"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"batchnorm_9"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_4/in1"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_9"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_11"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_9"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_5/in2"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"batchnorm_12"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_5/in1"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_11"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_13"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_11"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_6/in2"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"batchnorm_14"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_6/in1"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_13"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_17"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_13"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_15"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"batchnorm_16"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_7/in1"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"batchnorm_17"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_7/in2"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_15"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_18"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_15"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_8/in2"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"batchnorm_19"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_8/in1"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_17"</span><span >,</span><span style="color: rgb(170, 4, 249);">"conv_20"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"relu_17"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_9/in2"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lgraph = connectLayers(lgraph,</span><span style="color: rgb(170, 4, 249);">"batchnorm_21"</span><span >,</span><span style="color: rgb(170, 4, 249);">"addition_9/in1"</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div></div><h1  class = 'S7'><span style=' font-weight: bold;'>Create and Initialize the Network</span></h1><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >dlNet  = dlnetwork(lgraph);  </span><span style="color: rgb(2, 128, 9);">% Returns an initialized network; see convolution2dLayer &amp; batchNormalizationLayer</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div></div><h1  class = 'S7'><span style=' font-weight: bold;'>Show important properties of the dlNet</span></h1><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >dlNet.Layers</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >dlNet.Learnables</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >dlNet.State</span></span></div></div></div><h1  class = 'S7'><span style=' font-weight: bold;'>See graphical architecture</span></h1><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >figure(1),</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >plot(lgraph),</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >title(</span><span style="color: rgb(170, 4, 249);">"Architecture of DNN"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div></div><h1  class = 'S7'><span style=' font-weight: bold;'>Compute number of parameters</span></h1><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >[total, detailes] = find_num_parameters(dlNet);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">'\n The number of learnable parameters: '</span><span >), disp(total)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div></div><h1  class = 'S7'><span style=' font-weight: bold;'>Training Options</span></h1><div  class = 'S1'><span> </span><span style=' font-weight: bold;'>REMARK: </span><span>In this program </span><span style=' font-family: monospace;'>os</span><span> is a multiple of </span><span style=' font-family: monospace;'>num_of_Train_Images</span><span> and thus </span><span style=' font-family: monospace;'>or</span><span> a </span><span style=' font-family: monospace;'>rs</span><span> are not applicable. However, since </span><span style=' font-family: monospace;'>get_Jk.m</span><span> has been written as a comprehensive sub-rutine which needs "overlap ratio" (</span><span style=' font-family: monospace;'>or</span><span>) a "remain size" (</span><span style=' font-family: monospace;'>rs</span><span>), they are computed below.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">global </span><span >show</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >show                   = 0; </span><span style="color: rgb(2, 128, 9);">% see TRsubproblem_solver_OBB</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >S                      = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >Y                      = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >tol                    = 1e-5;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >delta                  = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >gamma                  = 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >epoch                  = 10;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >lim_m                  = 20;                                   </span><span style="color: rgb(2, 128, 9);">% limited memory</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >os                     = 50;                                   </span><span style="color: rgb(2, 128, 9);">% overlap size</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >Nb                     = floor( num_of_Train_Images /os ) - 1; </span><span style="color: rgb(2, 128, 9);">% number of multi-batch</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >rs                     = mod( num_of_Train_Images, os );       </span><span style="color: rgb(2, 128, 9);">% remain size</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >or                     = os / (2*os + rs);                     </span><span style="color: rgb(2, 128, 9);">% overlap ratio</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >skip                   = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >k                      = 0;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span >epoch_k                = 0;</span></span></div></div></div><h1  class = 'S7'><span style=' font-weight: bold;'>Train Network</span></h1><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">"\n====================================================================\n"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">"Start Training..."</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">"\n====================================================================\n"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >start = tic;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">while </span><span >(1)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    fprintf(</span><span style="color: rgb(170, 4, 249);">'\n ===================&gt;&gt;&gt; Iteration k : %d \n'</span><span >, k)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">%-----------------------------&gt; Computations at current (duplex) multi-batch</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >k == 0 </span><span style="color: rgb(2, 128, 9);">% Initial shuffling + initial duplex mini-batch:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        shuffel_index                                = randperm( num_of_Train_Images );</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        [X_set1, Y_set1, X_set2, Y_set2, ~, ~, ~]    = get_Jk(k, Nb, rs, os, num_of_Train_Images, XTrain, YTrain, shuffel_index);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        [grad_set1, loss_set1, acc_set1, state_set1] = dlfeval(@model_Forward_Backward, dlNet, X_set1, Y_set1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        [grad_set2, loss_set2, acc_set2, state_set2] = dlfeval(@model_Forward_Backward, dlNet, X_set2, Y_set2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        f_set1             = double(gather(extractdata( loss_set1 )));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        g_set1             = table_2_vec( grad_set1 );</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        f_set2             = double(gather(extractdata( loss_set2 )));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        g_set2             = table_2_vec( grad_set2 );</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">else </span><span style="color: rgb(2, 128, 9);">% k ~= 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">if </span><span >mod(k+1,Nb) ~=0  </span><span style="color: rgb(2, 128, 9);">% Duplex mini-batches within the epoch:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            [X_set1, Y_set1, X_set2, Y_set2, ~, ~, ~]             = get_Jk(k, Nb, rs, os, num_of_Train_Images, XTrain, YTrain, shuffel_index);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">else </span><span style="color: rgb(2, 128, 9);">% Last duplex mini-batch + new shuffling:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            [X_set1, Y_set1, X_set2, Y_set2, ~, ~, shuffel_index] = get_Jk(k, Nb, rs, os, num_of_Train_Images, XTrain, YTrain, shuffel_index);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            epoch_k                                               = epoch_k + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        [grad_set2, loss_set2, acc_set2, state_set2]              = dlfeval(@model_Forward_Backward, dlNet, X_set2, Y_set2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        f_set2         = double(gather(extractdata( loss_set2 )));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        g_set2         = table_2_vec( grad_set2 );</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    acc            = (acc_set1 + acc_set2)./2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    f              = (f_set1 + f_set2)./2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    g              = (g_set1 + g_set2)./2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    llgll          = norm(g);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    dlNet.State    = state_set1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    dlNet.State    = state_set2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">%-----------------------------&gt; TR subproblem:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >k == 0 || size(S,2) == 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        p                  = -delta*(g/llgll); </span><span style="color: rgb(2, 128, 9);">% llpll &lt;= delta</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        Bp                 = gamma*p;          </span><span style="color: rgb(2, 128, 9);">% B0*p for Q(p) = p'*g + 1/2 p'*B0*p</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        p                  = TRsubproblem_solver_OBS(delta, gamma, g, Psi, Minv);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        Bp                 = gamma*p + Psi*(Minv\(Psi'*p));   </span><span style="color: rgb(2, 128, 9);">% Bk*p for Q(p) = p'*g * 1/2 p'*(B0 + psi*M*Psi')*p</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    Q_p                = p'*(g + 0.5*Bp);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    llpll              = norm(p);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">%-----------------------------&gt; Computation at trial point (See Figure.1):</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    dlDir            = vec_2_table(dlNet, p);         </span><span style="color: rgb(2, 128, 9);">% a table whose values are the elemnts of p</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    dlNet_trial      = update_dlNet(dlNet, dlDir);    </span><span style="color: rgb(2, 128, 9);">% dlNet.Learnables +  dlDir:  w + p</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    [grad_new_set1, loss_new_set1]                               = dlfeval(@model_Forward_Backward, dlNet_trial, X_set1, Y_set1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    [grad_new_set2, loss_new_set2, acc_new_set2, state_new_set2] = dlfeval(@model_Forward_Backward, dlNet_trial, X_set2, Y_set2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    g_new_set1       = table_2_vec( grad_new_set1 );</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    g_new_set2       = table_2_vec( grad_new_set2 );</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    g_new            = (g_new_set1 + g_new_set2)./2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    f_new_set1       = double(gather(extractdata( loss_new_set1 )));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    f_new_set2       = double(gather(extractdata( loss_new_set2 )));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    f_new            = (f_new_set1 + f_new_set2)./2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">%-----------------------------&gt;  Curvature pair (s,y):</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    s                         = p;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    y                         = g_new - g;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">%-----------------------------&gt; Rho</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    rho                       = ( f_new - f ) / Q_p;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">%-----------------------------&gt; Acceptance Condition:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >rho &gt; 1e-4</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        dlNet       = dlNet_trial;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        state_set1  = state_new_set2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        g_set1      = g_new_set2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        f_set1      = f_new_set2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        acc_set1    = acc_new_set2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        skip        = skip + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        state_set1  = state_set2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        g_set1      = g_set2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        f_set1      = f_set2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        acc_set1    = acc_set2;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">%-----------------------------&gt; Evaluate Network:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    dlNet_optimal   = dlNet;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    YPred           = predict(dlNet_optimal, XTest);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    loss_test       = crossentropy(YPred, YTest);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    f_test          = double(gather(extractdata(loss_test)));</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    [~,idx_pred]    = max( (extractdata(YPred)), [], 1 );</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    [~,idx_true]    = max(YTest, [], 1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    acc_test        = mean(idx_pred == idx_true)*100;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">%-----------------------------&gt; Collect Info:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    Time_(k+1,1) = toc(start);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    F_(k+1, 1) = f;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    Acc_(k+1, 1) = acc; </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    F_t(k+1, 1) = f_test;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    Acc_t(k+1, 1) = acc_test;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">%-----------------------------&gt; Exit conditions:  </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >llgll &lt; tol || acc &gt;= 100 || epoch_k == epoch</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        fprintf(</span><span style="color: rgb(170, 4, 249);">'\n Training Stopped! \n '</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">return</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">%-----------------------------&gt; TR Radius:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >rho &gt; 0.75</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">if </span><span >norm(p)&lt;= 0.8*delta</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            delta_new = delta;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            delta_new = 2*delta;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">elseif </span><span >(0.1 &lt;= rho &amp;&amp; rho &lt;= 0.75)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        delta_new = delta;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        delta_new = 0.5*delta;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    delta  = delta_new;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">%-----------------------------&gt;  Bk = gamma*I + psi*M*Psi':</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(2, 128, 9);">% -- updating condition:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    y_Bs  = y - Bp;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >abs(s'* y_Bs) &gt; 1e-8*llpll*norm(y_Bs)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(2, 128, 9);">%-- S, Y:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        S = [S, s];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        Y = [Y, y];</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">if </span><span >( size(S,2) &gt; lim_m )</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            S  = S(:, 2:end);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            Y  = Y(:, 2:end);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">if </span><span >size(S,2) == 0</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            warning(</span><span style="color: rgb(170, 4, 249);">'S is empty!'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">while </span><span >( size(S, 2) &gt; 0 )</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            SY      = S'*Y;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            SS      = S'*S;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            LDLt    = tril(SY) + tril(SY,-1)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            eig_val       = eig(LDLt,SS);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            lambdaHat_min = min(eig_val);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">if </span><span >lambdaHat_min&gt;0</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >                gamma = max( 0.5*lambdaHat_min,  1e-6 );</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >                gamma = min( 1.5*lambdaHat_min, -1e-6 );</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            Minv    = (LDLt - gamma*SS);        </span><span style="color: rgb(2, 128, 9);">% Minv = (L+D+L'-S'*B0*S)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            Psi     = Y - gamma*S;              </span><span style="color: rgb(2, 128, 9);">% Psi  = Y-B0*S:</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">if</span><span >  size(Psi,2) == rank(Psi) &amp;&amp; rank(Minv) == size(Minv,2)  </span><span style="color: rgb(2, 128, 9);">% Starting removing columns so that Psi and Minv be full c.ranks.</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >                </span><span style="color: rgb(14, 0, 255);">break</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >                fprintf(</span><span style="color: rgb(170, 4, 249);">'\n Psi is NOT full column rank! or M is Not invertable!\n'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >                S  = S(:, 2:end);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >                Y  = Y(:, 2:end);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >            </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">end </span><span style="color: rgb(2, 128, 9);">%while</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end </span><span style="color: rgb(2, 128, 9);">%if</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    k = k + 1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end </span><span style="color: rgb(2, 128, 9);">% loop</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">"\n End of Training!"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(170, 4, 249);">"\n===================================================================\n"</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div></div><h1  class = 'S0'><span style=' font-weight: bold;'>Models</span></h1><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S4'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">function </span><span >[gradients, loss, acc, state] = model_Forward_Backward(dlNet, dlX, Y)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >nargout == 2</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    Yhat              = forward(dlNet, dlX);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    loss              = crossentropy(Yhat, Y);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    gradients         = dlgradient(loss, dlNet.Learnables);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">elseif </span><span >nargout == 3</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    Yhat              = forward(dlNet, dlX);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    loss              = crossentropy(Yhat, Y);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    gradients         = dlgradient(loss, dlNet.Learnables);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    acc               = accuracy_fun(Yhat, Y);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">elseif </span><span >nargout == 4</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    [Yhat, state]     = forward(dlNet, dlX);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    loss              = crossentropy(Yhat, Y);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    gradients         = dlgradient(loss, dlNet.Learnables);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >    acc               = accuracy_fun(Yhat, Y);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">function </span><span >acc = accuracy_fun(Y_pre, Y)</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >Y_predict    = extractdata(Y_pre);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >[~,idx_pre]  = max(Y_predict,[],1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >[~,idx_true] = max(Y,[],1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre"><span >acc          = mean(idx_pre == idx_true)*100;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h1  class = 'S7'><span style=' font-weight: bold;'>Sampling strategy (Batch formation)</span></h1><div  class = 'S1'><span style=' font-weight: bold;'>Figure.1</span></div><div  class = 'S1'><img class = "imageNode" src = "data:image/jpeg;base64,/9j/4AAQSkZJRgABAgAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAHkBLADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD3+iiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKA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8IYv/Qw+IP8AwN/+tR/whi/9DD4g/wDA3/61dRRR7SXcPZx7HL/8IWv/AEMPiD/wN/8ArUf8IWv/AEMPiD/wN/8Asa6iij2ku4ezj2MbQ/DkGiXF1Ol3eXM1yEEkl1IHY7c45wPX9K2qKKltt3ZSSWiCiiikMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAMDxN10j/sJQ/1p2h/8hbWv+vhf/Qab4m66R/2Eof607Q/+QtrX/Xwv/oNbx/hv0/U53/EXr+hu0UUVgdAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAVkeJ/+Rdu/ov/AKGK16yPE/8AyLt39F/9DFABB/yNF3/17p/OtesiD/kaLv8A690/nWvQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAGB4m66R/2Eof607Q/+QtrX/Xwv/oNN8TddI/7CUP9adof/IW1r/r4X/0Gt4/w36fqc7/iL1/Q3aKKKwOgKKKKACiiigAooooAKKKKACiiigAooooAKyPE/wDyLt39F/8AQxWvWR4n/wCRdu/ov/oYoAIP+Rou/wDr3T+da9ZEH/I0Xf8A17p/OtegAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAMDxN10j/sJQ/1p2h/8hbWv+vhf/Qab4m66R/2Eof607Q/+QtrX/Xwv/oNbx/hv0/U53/EXr+hu0UUVgdAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAVkeJ/wDkXbv6L/6GK16yPE//ACLt39F/9DFABB/yNF3/ANe6fzrXrIg/5Gi7/wCvdP51r0AFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQBgeJuukf9hKH+tO0P8A5C2tf9fC/wDoNN8TddI/7CUP9adof/IW1r/r4X/0Gt4/w36fqc7/AIi9f0N2iiisDoCiiigAooooAKKKKACiiigAooooAKKKKACsjxP/AMi7d/Rf/QxWvWR4n/5F27+i/wDoYoAIP+Rou/8Ar3T+da9ZEH/I0Xf/AF7p/OtegAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACjNFcb4o+IeneEtZsNM1PTtTP29wkFxDHG0TEkA/x543DPHfjNAHY5FGRjOeKztc1a30DQ73VbwOba0iaWRUALMAM4AJAJPTqKr+H/ENr4m8NW2uafDObe4RnjifaJOCQRw2AcgjrigDZyKWuP8ACnxC07xfq+o6XaafqVrc6cdtwLyJFCtuKlcqzfNkH8jXYZoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiimtQA7NJketcdZ/ETT7rx03hCTTNTtdTVWYGaOPy2UDdkMrngjnp7daueNfG2meBdIh1LVYrmWKacQKlsqs+4qzZwxHHy+vcUAdNkUA5rK1vV10TRLnVHtLm8gt4zI8dqELlAMkgMwBAHPBz9ap+DfF1j410M6vp0F3Db+a0QF0iqxK4yRgkY5x17GgDoaKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigDA8TddI/7CUP8AWnaH/wAhbWv+vhf/AEGm+Juukf8AYSh/rTtD/wCQtrX/AF8L/wCg1vH+G/T9Tnf8Rev6G7RRRWB0BRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABWR4n/5F27+i/wDoYrXrI8T/APIu3f0X/wBDFABB/wAjRd/9e6fzrXrIg/5Gi7/690/nWvQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABXjX7QqG38P6DqYBzbakACDyCVLcH/AIBXstecfG7RrvXPh3JBY2U95dRXUUscUEbO55KnAAz0Y0AT/ErfrtvbeDrV8SagrXN2ytgx20WGJ/4E4VfxNYvwp8Q22h/AtNUvWxb6d9oLDpu/eFgo9yWwPc11PgXQ72200azrw36/qESfaCRjyYhny4QOgCg89ySSSeK88+GHgfWZ0udM8Q2k1v4c0/UHuILOaMobubgKxzy0ahcgdGLc5xgAHafDLQLrQPCNzqt9avLrOrSPqF1FHgOxbLLGNxUA4PcgAsecVs+EvGtl4xGofY7K+tfsE/2eYXaoD5ncDazZxj9a1de1NdF8PajqbYxaW0k/PcqpIH6V4/8ADrXo7L4eQ6Rod1BeeMNXM90yCRSIHYkebMTkAKoU7cEnoBzmgD3HIxS1k6BZapYaYkOrau+qXp5knaGOJQfRVRRx9cn3rWoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA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AUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUhODjFG4UALRSZo3e1AC0UgOaWgAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACsjxP/yLt39F/wDQxWvWR4n/AORdu/ov/oYoAIP+Rou/+vdP51r1kQf8jRd/9e6fzrXoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK8o+K/iPxH4R1fQLvTdaeLTr25ENzbvbxMqgFSSG27uQTnntxXq9eQ/tD27HwLYXkZ2yW2oowb0BR/67aAO2+IOvy+GfAmq6pbSeXdpFstztDESuQqkA5BwTnHtVX4a63feKPhxpup6hcl764WVZZlVQcrI6ggAbQcAHpWexX4g+IZYSo/sPR9vK8ie9ZDwT3WNX9jvIPauD+Hnia+tfhXZeH9H2/2/e6hNZWynkwLw8kzDqAgY9e5FAHX/AAs1vxPruseI5NV1ZtQ0iyumtLOVreKPzGVjlsoo/h2nv96vTs81haD4ZsvC/hWPRdNnmgiijYC5ypkDNkmTLAqTk55BHtjiuQ+G/i3UL3whrHiXxFqU9xp8N3ILZzaruWBAPmKxRgnqcnB6dqAPTaKxPDnizRvFlnJeaJeG6t45PLaQwyRjdjOBvAzx6VD418Uf8If4Svtd+yC7+y+WPJ83y9+6RU+9g4xuz0oA6GioYZjLbRSldu9A2M5xkZrH1/VtYtGS00TRWvruVCwmmkEVvFj++3Un2UH6jrQBug0tcR8LvF+oeNvCZ1bUYbaGcXTw7LZCqYUKR94se57129ABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAIRmvKdN8ReI7P46TeFb/WZLvS3tmmgSS3iRuUDAFkQE4ww/CvV68Z8WzRaL+0X4b1OeRYraXTpPOd22gbUmBJPoBt/KgDR+NPjvU/B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q1/9FLUX/Cv/AAwP+YYf/AiX/wCKpsfw78KxRrGmlBUUBVUTyYAHb71K0e7+7/gh73Y6bP8AnNGf85rm/wDhX3hj/oGf+TEv/wAVR/wr7wx/0DP/ACYk/wDiqdo9393/AAQ97sjpM/5zRn/Oa5v/AIV94Y/6Bn/kxJ/8VR/wr7wx/wBAz/yYk/8AiqLR7v7v+CF59kdJn/OaM/5zXN/8K+8Mf9Az/wAmJP8A4qj/AIV94Y/6Bn/kxJ/8VRaPf8P+CF59kdJurmdF/wCR38Uf9un/AKLNO/4V94X/AOgZ/wCTEv8A8VWnpHh7S9CM39m2vkedt8z94zZxnH3ifU0e6k7dRWk2mzSHSlooqDQKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//9k=" width = "619" height = "249" alt = "Sampling_Schematic.JPG" style = "vertical-align: baseline"></img></div><div  class = 'S1'></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% *Algorithm sL-SR1-TR*
% This document provides step by step programing for training ResNet-20 or ConvNet3FC2 
% *with BN layers* on MNIST, Fashion MNIST or CIFAR10. 
%% 
% * Notice to the structure of networks including BN layers. 
% * Notice to make coments (|%|) other networks and datasets after selecting 
% one of them.
% * Notice to TR solver and gamma computation. 
%% 
% *Defaults:* |os   = 500  (bs = 1000), epoch  = 10 ,  lim_m = 20|

clear
clc
close all
rng default

%% *Load Data*
% *Train and Test (images): 4D double*
% 
% *Train and Test (label): categorical*
%% *1. MNIST*

[XTrain, yTrain, XTest, yTest] = loadDataMnist;
input_image_size               = [28 28 1];
%% 2. Fashion-MNIST


% [XTrain, yTrain, XTest, yTest] = loadData_FashionMnist;
% input_image_size               = [28 28 1];
%% 3. CIFAR10

% [XTrain, yTrain, XTest, yTest] = loadDataCifar10;
% input_image_size               = [32 32 3];
%% 
% 

classes                       = categories(yTrain);
numClasses                    = numel(classes);  % 10
num_of_Train_Images           = size(XTrain,4);  % 50,000 (Cifar10) or 60,000 (Mnist and F.Mnist)
num_of_Test_Images            = size(XTest,4);   % 10,000
%% *One-hot label*

% One-hot labels for train set:

YTrain = zeros(numClasses, num_of_Train_Images, 'single');
for c  = 2:10
    YTrain( c-1, yTrain == classes(c)) = 1;
end
YTrain( 10, yTrain == classes(1)) = 1;


% One-hot labels for test set:

YTest = zeros(numClasses, num_of_Test_Images, 'single');
for c = 2:10
    YTest( c-1, yTest == classes(c) ) = 1;
end
YTest( 10, yTest == classes(1) ) = 1;
%% *Convert Test set from 4D double to 4D single > dlArray > gpuArray*

executionEnvironment = "auto";

XTest   = dlarray(single(XTest),'SSCB');
if (executionEnvironment == "auto" && canUseGPU) || executionEnvironment == "gpu"
    XTest = gpuArray(XTest);
end
%% 
% *NOTE:* This conversion needs also for train set but after making mini- or 
% multi-batches; (see |get_Jk.m|) 
%% *Architecture of Network with BN*
%% *1. ConvNet3FC2*

% layers = [
%     imageInputLayer(input_image_size, 'Name', 'input', 'Normalization','zscore',...
%     'Mean', mean(XTrain,4), 'StandardDeviation', std(XTrain, 0, 4))
%     
%     % ConvNet
%     
%     convolution2dLayer(5, 32, 'Stride', 1,'Padding', 2,'Name','conv1')
%     batchNormalizationLayer('Name','bn1')
%     reluLayer('Name','relu1')
%     maxPooling2dLayer(2,'Stride', 1, 'Name', 'pooling_max1')
%     
%     % ConvNet
% 
%     convolution2dLayer(5, 32,'Stride', 1, 'Padding', 2,'Name','conv2')
%     batchNormalizationLayer('Name','bn2')
%     reluLayer('Name','relu2')
%     maxPooling2dLayer(2,'Stride', 1, 'Name', 'pooling_max2')
%     
%     % ConvNet
%     
%     convolution2dLayer(5, 64,'Stride', 1,'Padding', 2,'Name','conv3')
%     batchNormalizationLayer('Name','bn3')
%     reluLayer('Name','relu3')
%     maxPooling2dLayer(2,'Stride', 1, 'Name', 'pooling_max3')
%     
%     % FC
% 
%     fullyConnectedLayer(64,'Name','fc1')
%     batchNormalizationLayer('Name','bn4')
%     reluLayer('Name','relu4')
%     
%     % FC
%     
%     fullyConnectedLayer(numClasses,'Name','fc2')
%     softmaxLayer('Name','softmax')];
% 
% 
% lgraph = layerGraph(layers);
%% *2. ResNet-20*

lgraph = layerGraph();

tempLayers = [

imageInputLayer(input_image_size, 'Name', 'imageinput', 'Normalization','zscore',...
'Mean', mean(XTrain,4), 'StandardDeviation', std(XTrain, 0, 4))
convolution2dLayer([3 3],16,"Name","conv_1","Padding",[1 1 1 1])
batchNormalizationLayer("Name","batchnorm_1")
reluLayer("Name","relu_1")];
lgraph = addLayers(lgraph,tempLayers);

% B1:

tempLayers = [
    convolution2dLayer([3 3],16,"Name","conv_2","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_2")
    reluLayer("Name","relu_2")
    convolution2dLayer([3 3],16,"Name","conv_3","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_3")];
lgraph = addLayers(lgraph,tempLayers);

tempLayers = [
    additionLayer(2,"Name","addition_1")
    reluLayer("Name","relu_3")];
lgraph = addLayers(lgraph,tempLayers);


% B2:

tempLayers = [
    convolution2dLayer([3 3],16,"Name","conv_4","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_4")
    reluLayer("Name","relu_4")
    convolution2dLayer([3 3],16,"Name","conv_5","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_5")];
lgraph = addLayers(lgraph,tempLayers);

tempLayers = [
    additionLayer(2,"Name","addition_2")
    reluLayer("Name","relu_5")];
lgraph = addLayers(lgraph,tempLayers);


% B3:

tempLayers = [
    convolution2dLayer([3 3],16,"Name","conv_6","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_6")
    reluLayer("Name","relu_6")
    convolution2dLayer([3 3],16,"Name","conv_7","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_7")];
lgraph = addLayers(lgraph,tempLayers);

tempLayers = [
    additionLayer(2,"Name","addition_3")
    reluLayer("Name","relu_7")];
lgraph = addLayers(lgraph,tempLayers);

%===========================================================

% B1:

tempLayers = [
    convolution2dLayer([3 3],32,"Name","conv_8","Padding",[1 1 1 1],"Stride",[2 2])
    batchNormalizationLayer("Name","batchnorm_8")
    reluLayer("Name","relu_8")
    convolution2dLayer([3 3],32,"Name","conv_9","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_9")];
lgraph = addLayers(lgraph,tempLayers);

tempLayers = [
    convolution2dLayer([1 1],32,"Name","conv_10","Stride",[2 2])
    batchNormalizationLayer("Name","batchnorm_10")];
lgraph = addLayers(lgraph,tempLayers);

tempLayers = [
    additionLayer(2,"Name","addition_4")
    reluLayer("Name","relu_9")];
lgraph = addLayers(lgraph,tempLayers);


% B2:


tempLayers = [
    convolution2dLayer([3 3],32,"Name","conv_11","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_11")
    reluLayer("Name","relu_10")
    convolution2dLayer([3 3],32,"Name","conv_12","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_12")];
lgraph = addLayers(lgraph,tempLayers);

tempLayers = [
    additionLayer(2,"Name","addition_5")
    reluLayer("Name","relu_11")];
lgraph = addLayers(lgraph,tempLayers);


% B3:

tempLayers = [
    convolution2dLayer([3 3],32,"Name","conv_13","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_13")
    reluLayer("Name","relu_12")
    convolution2dLayer([3 3],32,"Name","conv_14","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_14")];
lgraph = addLayers(lgraph,tempLayers);

tempLayers = [
    additionLayer(2,"Name","addition_6")
    reluLayer("Name","relu_13")];
lgraph = addLayers(lgraph,tempLayers);

%===========================================================

% B1:

tempLayers = [
    convolution2dLayer([3 3],64,"Name","conv_15","Padding",[1 1 1 1],"Stride",[2 2])
    batchNormalizationLayer("Name","batchnorm_15")
    reluLayer("Name","relu_14")
    convolution2dLayer([3 3],64,"Name","conv_16","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_16")];
lgraph = addLayers(lgraph,tempLayers);


tempLayers = [
    convolution2dLayer([1 1],64,"Name","conv_17","Stride",[2 2])
    batchNormalizationLayer("Name","batchnorm_17")];
lgraph = addLayers(lgraph,tempLayers);



tempLayers = [
    additionLayer(2,"Name","addition_7")
    reluLayer("Name","relu_15")];
lgraph = addLayers(lgraph,tempLayers);

% B2:


tempLayers = [
    convolution2dLayer([3 3],64,"Name","conv_18","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_18")
    reluLayer("Name","relu_16")
    convolution2dLayer([3 3],64,"Name","conv_19","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_19")];
lgraph = addLayers(lgraph,tempLayers);

tempLayers = [
    additionLayer(2,"Name","addition_8")
    reluLayer("Name","relu_17")];
lgraph = addLayers(lgraph,tempLayers);


% B3:

tempLayers = [
    convolution2dLayer([3 3],64,"Name","conv_20","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_20")
    reluLayer("Name","relu_18")
    convolution2dLayer([3 3],64,"Name","conv_21","Padding",[1 1 1 1])
    batchNormalizationLayer("Name","batchnorm_21")];
lgraph = addLayers(lgraph,tempLayers);

tempLayers = [
    additionLayer(2,"Name","addition_9")
    reluLayer("Name","relu_19")
    globalAveragePooling2dLayer("Name","gapool")
    fullyConnectedLayer(10,"Name","fc")
    softmaxLayer("Name","softmax")];
lgraph = addLayers(lgraph,tempLayers);

% clean up helper variable
clear tempLayers;

lgraph = connectLayers(lgraph,"relu_1","conv_2");
lgraph = connectLayers(lgraph,"relu_1","addition_1/in2");
lgraph = connectLayers(lgraph,"batchnorm_3","addition_1/in1");


lgraph = connectLayers(lgraph,"relu_3","conv_4");
lgraph = connectLayers(lgraph,"relu_3","addition_2/in2");
lgraph = connectLayers(lgraph,"batchnorm_5","addition_2/in1");


lgraph = connectLayers(lgraph,"relu_5","conv_6");
lgraph = connectLayers(lgraph,"relu_5","addition_3/in2");
lgraph = connectLayers(lgraph,"batchnorm_7","addition_3/in1");


lgraph = connectLayers(lgraph,"relu_7","conv_8");
lgraph = connectLayers(lgraph,"relu_7","conv_10");
lgraph = connectLayers(lgraph,"batchnorm_10","addition_4/in2");
lgraph = connectLayers(lgraph,"batchnorm_9","addition_4/in1");


lgraph = connectLayers(lgraph,"relu_9","conv_11");
lgraph = connectLayers(lgraph,"relu_9","addition_5/in2");
lgraph = connectLayers(lgraph,"batchnorm_12","addition_5/in1");


lgraph = connectLayers(lgraph,"relu_11","conv_13");
lgraph = connectLayers(lgraph,"relu_11","addition_6/in2");
lgraph = connectLayers(lgraph,"batchnorm_14","addition_6/in1");


lgraph = connectLayers(lgraph,"relu_13","conv_17");
lgraph = connectLayers(lgraph,"relu_13","conv_15");
lgraph = connectLayers(lgraph,"batchnorm_16","addition_7/in1");
lgraph = connectLayers(lgraph,"batchnorm_17","addition_7/in2");


lgraph = connectLayers(lgraph,"relu_15","conv_18");
lgraph = connectLayers(lgraph,"relu_15","addition_8/in2");
lgraph = connectLayers(lgraph,"batchnorm_19","addition_8/in1");


lgraph = connectLayers(lgraph,"relu_17","conv_20");
lgraph = connectLayers(lgraph,"relu_17","addition_9/in2");
lgraph = connectLayers(lgraph,"batchnorm_21","addition_9/in1");

%% *Create and Initialize the Network*


dlNet  = dlnetwork(lgraph);  % Returns an initialized network; see convolution2dLayer & batchNormalizationLayer

%% *Show important properties of the dlNet*

dlNet.Layers
dlNet.Learnables
dlNet.State
%% *See graphical architecture*

figure(1),
plot(lgraph),
title("Architecture of DNN")

%% *Compute number of parameters*


[total, detailes] = find_num_parameters(dlNet);
fprintf('\n The number of learnable parameters: '), disp(total)

%% *Training Options*
% *REMARK:* In this program |os| is a multiple of |num_of_Train_Images| and 
% thus |or| a |rs| are not applicable. However, since |get_Jk.m| has been written 
% as a comprehensive sub-rutine which needs "overlap ratio" (|or|) a "remain size" 
% (|rs|), they are computed below.

global show
show                   = 0; % see TRsubproblem_solver_OBB

S                      = [];
Y                      = [];

tol                    = 1e-5;
delta                  = 1;
gamma                  = 1;

epoch                  = 10;
lim_m                  = 20;                                   % limited memory
os                     = 50;                                   % overlap size
Nb                     = floor( num_of_Train_Images /os ) - 1; % number of multi-batch
rs                     = mod( num_of_Train_Images, os );       % remain size
or                     = os / (2*os + rs);                     % overlap ratio

skip                   = 0;
k                      = 0;
epoch_k                = 0;
%% *Train Network*

fprintf("\n====================================================================\n")
fprintf("Start Training...")
fprintf("\n====================================================================\n")


start = tic;
while (1)

    fprintf('\n ===================>>> Iteration k : %d \n', k)
    
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-> Computations at current (duplex) multi-batch

    if k == 0 % Initial shuffling + initial duplex mini-batch:

        shuffel_index                                = randperm( num_of_Train_Images );
        [X_set1, Y_set1, X_set2, Y_set2, ~, ~, ~]    = get_Jk(k, Nb, rs, os, num_of_Train_Images, XTrain, YTrain, shuffel_index);
        [grad_set1, loss_set1, acc_set1, state_set1] = dlfeval(@model_Forward_Backward, dlNet, X_set1, Y_set1);
        [grad_set2, loss_set2, acc_set2, state_set2] = dlfeval(@model_Forward_Backward, dlNet, X_set2, Y_set2);


        f_set1             = double(gather(extractdata( loss_set1 )));
        g_set1             = table_2_vec( grad_set1 );


        f_set2             = double(gather(extractdata( loss_set2 )));
        g_set2             = table_2_vec( grad_set2 );


    else % k ~= 0

        if mod(k+1,Nb) ~=0  % Duplex mini-batches within the epoch:

            [X_set1, Y_set1, X_set2, Y_set2, ~, ~, ~]             = get_Jk(k, Nb, rs, os, num_of_Train_Images, XTrain, YTrain, shuffel_index);
        else % Last duplex mini-batch + new shuffling:

            [X_set1, Y_set1, X_set2, Y_set2, ~, ~, shuffel_index] = get_Jk(k, Nb, rs, os, num_of_Train_Images, XTrain, YTrain, shuffel_index);
            epoch_k                                               = epoch_k + 1;
        end

        [grad_set2, loss_set2, acc_set2, state_set2]              = dlfeval(@model_Forward_Backward, dlNet, X_set2, Y_set2);

        f_set2         = double(gather(extractdata( loss_set2 )));
        g_set2         = table_2_vec( grad_set2 );

    end
    
    acc            = (acc_set1 + acc_set2)./2;
    f              = (f_set1 + f_set2)./2;
    g              = (g_set1 + g_set2)./2;
    llgll          = norm(g);
    
    dlNet.State    = state_set1;
    dlNet.State    = state_set2;
        
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-> TR subproblem:
    if k == 0 || size(S,2) == 0
        p                  = -delta*(g/llgll); % llpll <= delta
        Bp                 = gamma*p;          % B0*p for Q(p) = p'*g + 1/2 p'*B0*p
    else
        p                  = TRsubproblem_solver_OBS(delta, gamma, g, Psi, Minv);
        Bp                 = gamma*p + Psi*(Minv\(Psi'*p));   % Bk*p for Q(p) = p'*g * 1/2 p'*(B0 + psi*M*Psi')*p
    end
    
    Q_p                = p'*(g + 0.5*Bp);
    llpll              = norm(p);
    
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-> Computation at trial point (See Figure.1):

    dlDir            = vec_2_table(dlNet, p);         % a table whose values are the elemnts of p
    dlNet_trial      = update_dlNet(dlNet, dlDir);    % dlNet.Learnables +  dlDir:  w + p


    [grad_new_set1, loss_new_set1]                               = dlfeval(@model_Forward_Backward, dlNet_trial, X_set1, Y_set1);
    [grad_new_set2, loss_new_set2, acc_new_set2, state_new_set2] = dlfeval(@model_Forward_Backward, dlNet_trial, X_set2, Y_set2);

    g_new_set1       = table_2_vec( grad_new_set1 );
    g_new_set2       = table_2_vec( grad_new_set2 );
    g_new            = (g_new_set1 + g_new_set2)./2;


    f_new_set1       = double(gather(extractdata( loss_new_set1 )));
    f_new_set2       = double(gather(extractdata( loss_new_set2 )));
    f_new            = (f_new_set1 + f_new_set2)./2;

    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH->  Curvature pair (s,y):
    s                         = p;
    y                         = g_new - g;

    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-> Rho
    rho                       = ( f_new - f ) / Q_p;

    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-> Acceptance Condition:
    if rho > 1e-4
        
        dlNet       = dlNet_trial;
        state_set1  = state_new_set2;

        g_set1      = g_new_set2;
        f_set1      = f_new_set2;
        acc_set1    = acc_new_set2;
    else
        skip        = skip + 1;
        state_set1  = state_set2;

        g_set1      = g_set2;
        f_set1      = f_set2;
        acc_set1    = acc_set2;
    end

    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-> Evaluate Network:

    dlNet_optimal   = dlNet;
    YPred           = predict(dlNet_optimal, XTest);
    loss_test       = crossentropy(YPred, YTest);
    f_test          = double(gather(extractdata(loss_test)));
    [~,idx_pred]    = max( (extractdata(YPred)), [], 1 );
    [~,idx_true]    = max(YTest, [], 1);
    acc_test        = mean(idx_pred == idx_true)*100;


    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-> Collect Info:
    
    Time_(k+1,1) = toc(start);
    F_(k+1, 1) = f;
    Acc_(k+1, 1) = acc; 
    F_t(k+1, 1) = f_test;
    Acc_t(k+1, 1) = acc_test;
    
    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-> Exit conditions:  

    if llgll < tol || acc >= 100 || epoch_k == epoch
        fprintf('\n Training Stopped! \n ')
        
        return
    end

    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-> TR Radius:

    if rho > 0.75
        if norm(p)<= 0.8*delta
            delta_new = delta;
        else
            delta_new = 2*delta;
        end
    elseif (0.1 <= rho && rho <= 0.75)
        delta_new = delta;
    else
        delta_new = 0.5*delta;
    end
    delta  = delta_new;

    %REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH->  Bk = gamma*I + psi*M*Psi':

    % REPLACE_WITH_DASH_DASH updating condition:
    
    y_Bs  = y - Bp;
    
    if abs(s'* y_Bs) > 1e-8*llpll*norm(y_Bs)

        %REPLACE_WITH_DASH_DASH S, Y:
        S = [S, s];
        Y = [Y, y];
        if ( size(S,2) > lim_m )
            S  = S(:, 2:end);
            Y  = Y(:, 2:end);
        end

        if size(S,2) == 0
            warning('S is empty!')
        end

        while ( size(S, 2) > 0 )

            SY      = S'*Y;
            SS      = S'*S;
            LDLt    = tril(SY) + tril(SY,-1)';

            eig_val       = eig(LDLt,SS);
            lambdaHat_min = min(eig_val);
            if lambdaHat_min>0
                gamma = max( 0.5*lambdaHat_min,  1e-6 );
            else
                gamma = min( 1.5*lambdaHat_min, -1e-6 );
            end

            Minv    = (LDLt - gamma*SS);        % Minv = (L+D+L'-S'*B0*S)
            Psi     = Y - gamma*S;              % Psi  = Y-B0*S:


            if  size(Psi,2) == rank(Psi) && rank(Minv) == size(Minv,2)  % Starting removing columns so that Psi and Minv be full c.ranks.
                break
            else
                fprintf('\n Psi is NOT full column rank! or M is Not invertable!\n')
                S  = S(:, 2:end);
                Y  = Y(:, 2:end);
            end
        end %while
    end %if

    k = k + 1;
end % loop

fprintf("\n End of Training!")
fprintf("\n===================================================================\n")


%% *Models*

function [gradients, loss, acc, state] = model_Forward_Backward(dlNet, dlX, Y)
if nargout == 2
    Yhat              = forward(dlNet, dlX);
    loss              = crossentropy(Yhat, Y);
    gradients         = dlgradient(loss, dlNet.Learnables);
elseif nargout == 3
    Yhat              = forward(dlNet, dlX);
    loss              = crossentropy(Yhat, Y);
    gradients         = dlgradient(loss, dlNet.Learnables);
    acc               = accuracy_fun(Yhat, Y);
elseif nargout == 4
    [Yhat, state]     = forward(dlNet, dlX);
    loss              = crossentropy(Yhat, Y);
    gradients         = dlgradient(loss, dlNet.Learnables);
    acc               = accuracy_fun(Yhat, Y);
end
end

function acc = accuracy_fun(Y_pre, Y)
Y_predict    = extractdata(Y_pre);
[~,idx_pre]  = max(Y_predict,[],1);
[~,idx_true] = max(Y,[],1);
acc          = mean(idx_pre == idx_true)*100;
end
%% *Sampling strategy (Batch formation)*
% *Figure.1*
% 
% 
% 
%
##### SOURCE END #####
-->
</div></body></html>